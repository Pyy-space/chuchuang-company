# 初创公司投资游戏

一个支持3-7人的多人在线桌游，模拟投资经营类卡牌游戏。

## 游戏介绍

玩家通过投资6家不同的公司、争夺大股东地位来获取收益。游戏时长约20分钟/局。

## 主要特性

- 🎯 支持3-7人实时在线对战
- 🏢 6家公司的投资系统
- 💰 硬币双面增值机制
- 🔒 反垄断规则
- 📊 实时结算系统
- 🎨 响应式设计
- 🔄 多轮游戏支持

## 游戏规则

### 游戏组成
- **卡牌系统**：共45张卡牌，分属6家公司
  - A公司：5张
  - B公司：6张
  - C公司：7张
  - D公司：8张
  - E公司：9张
  - F公司：10张
- **硬币系统**：每枚硬币有"1"面和"3"面
- **大股东标记**：标识各公司的大股东

### 准备阶段
1. **洗牌**：将45张卡牌充分洗混
2. **移除卡牌**：从牌堆顶部移除5张牌（不参与本轮游戏）
3. **分发手牌**：每位玩家分发3张手牌
4. **分发硬币**：每位玩家获得10枚硬币，"1"面朝上
5. **设置市场**：从牌堆顶部翻开5张牌作为市场区域
6. **剩余卡牌**：放置为抽牌堆（背面朝上）

### 行动阶段（两步骤系统）⭐
**这是游戏的核心机制！** 玩家轮流行动，每回合**必须**完成两个步骤：

#### 第一步：拿取一张牌
从以下两个选项中选择一个：

1. **从抽牌堆抽牌**
   - 从牌堆顶部抽取一张牌
   - **支付规则**：市场区每有一张卡牌，就要支付1枚硬币
   - 支付的硬币放在对应的市场卡牌上
   - **例外**：如果你是某公司的大股东，且市场上全是该公司的牌，则**免费**抽牌

2. **从市场区拿牌**
   - 从市场区选择一张可见卡牌拿取
   - 拿走该卡牌上的所有硬币（如果有的话）
   - 市场区会从牌堆自动补充至5张

#### 第二步：打出一张牌
从手牌中选择一张牌，选择以下两个选项之一：

1. **打到市场区**
   - 将卡牌放入市场区（供其他玩家拿取）
   - **限制**：刚从市场拿回来的同公司卡牌，不能立即打回市场
   - **限制**：大股东不能将该公司的卡牌打到市场（反垄断规则）

2. **打到自己面前（投资）**
   - 将卡牌放在自己面前，计入该公司的投资
   - 已投资的卡牌无法取回

**重要**：完成两个步骤后，保持手牌始终为3张

### 反垄断规则 ⚠️
这是游戏的重要机制，包含三条限制：

1. **限制从市场拿牌**
   - 在某家公司投资牌数量最多的玩家成为该公司的**大股东**
   - 大股东**不能从市场中拿取**该公司的新牌
   - 但可以**从牌堆抽取**该公司的牌
   - 也可以**打出手中已有的牌**继续投资该公司

2. **限制打牌到市场**
   - 大股东**不能**将该公司的卡牌打到市场上
   - 只能选择投资到自己面前

3. **免费抽牌特权**
   - 当市场上**全部**是大股东公司的卡牌时
   - 大股东从牌堆抽牌**不需要支付**硬币

### 收益结算
当抽牌堆**和**市场区都耗尽时，进行收益结算：

#### 1. 确定大股东
在每家公司中，持有最多投资牌的玩家成为大股东（平局则无大股东）

#### 2. 支付硬币
- 其他持有该公司投资牌的玩家，每持有一张该公司投资牌，需向大股东**支付1枚硬币**
- 如果玩家硬币不足，将所有剩余硬币支付给大股东，并记录**负资产**
- 支付的硬币翻面为"3"，价值提升

#### 3. 排名与得分标记
根据每位玩家的**净资产**（硬币总价值 - 负资产）排名：
- **第一名**：+2分
- **第二名**：+1分
- **最后一名**：-1分
- **其他名次**：0分

得分标记累计到玩家的总分中

### 游戏结束
- 游戏进行多轮，每轮由不同玩家作为起始玩家
- 当所有玩家都作为起始玩家完成一轮后，游戏结束
- **总分最高者**获胜

## 技术栈

### 前端
- React 18 + TypeScript
- Tailwind CSS（响应式设计）
- Socket.io-client（实时通信）
- Vite（构建工具）

### 后端
- Node.js + Express
- Socket.io（WebSocket实时多人通信）
- TypeScript

## 本地开发

### 前置要求
- Node.js 18或更高版本
- npm或yarn

### 安装步骤

1. 克隆仓库
```bash
git clone <repository-url>
cd chuchuang-company
```

2. 安装服务端依赖
```bash
cd server
npm install
```

3. 安装客户端依赖
```bash
cd ../client
npm install
```

4. 配置环境变量

服务端：
```bash
cd server
cp .env.example .env
# 根据需要编辑 .env
```

客户端：
```bash
cd client
cp .env.example .env
# 根据需要编辑 .env
```

### 运行开发服务器

1. 启动服务端（终端1）
```bash
cd server
npm run dev
```

服务器将在 http://localhost:3001 运行

2. 启动客户端（终端2）
```bash
cd client
npm run dev
```

客户端将在 http://localhost:3000 运行

3. 在浏览器中打开 http://localhost:3000 开始游戏

## 部署指南

### 前端部署（Vercel）

1. 将代码推送到GitHub

2. 在Vercel中导入项目

3. 配置构建设置：
   - 根目录：`client`
   - 构建命令：`npm run build`
   - 输出目录：`dist`

4. 添加环境变量：
   - `VITE_SERVER_URL`: 你的后端服务器URL

5. 部署完成后，记录前端URL用于后端配置

### 后端部署（Railway）

1. 在Railway创建新项目

2. 连接GitHub仓库

3. 配置服务：
   - 根目录：`server`
   - 构建命令：`npm install && npm run build`
   - 启动命令：`npm start`

4. 添加环境变量：
   - `PORT`: Railway会自动设置
   - `CLIENT_URL`: 你的前端URL（Vercel URL）

### 后端部署（Render）

1. 在Render创建新Web Service

2. 连接GitHub仓库

3. 配置：
   - 根目录：`server`
   - 构建命令：`npm install && npm run build`
   - 启动命令：`npm start`

4. 环境变量：
   - `CLIENT_URL`: 你的前端URL

### 使用Docker部署

```bash
cd server
docker build -t chuchuang-game .
docker run -p 3001:3001 \
  -e CLIENT_URL=https://your-frontend.vercel.app \
  chuchuang-game
```

## 游戏玩法提示

### 四人游戏示例
假设4位玩家：Alice、Bob、Carol、David

**准备阶段**：
- 洗牌45张卡牌
- 移除5张（不参与游戏）
- 每人分发3张手牌
- 每人10枚硬币（值1）
- 市场区摆放5张牌

**游戏流程**：
1. Alice的回合：
   - 第一步：从牌堆抽牌（支付5枚硬币放在5张市场牌上）
   - 第二步：打出一张A公司的牌到自己面前投资
   
2. Bob的回合：
   - 第一步：从市场拿取一张B公司的牌（获得该牌上的1枚硬币）
   - 第二步：不能打出刚拿的B公司牌到市场，改为投资到自己面前
   
3. Carol的回合：
   - 第一步：从市场拿取一张C公司的牌（获得该牌上的2枚硬币）
   - 第二步：打出一张D公司的牌到市场

4. 继续轮流...直到牌堆和市场都空

**结算阶段**：
- Alice：A公司3张（大股东）、B公司1张，剩余8枚硬币
- Bob：B公司2张、C公司2张，剩余6枚硬币
- Carol：C公司3张（大股东）、A公司1张，剩余10枚硬币
- David：D公司4张（大股东），剩余5枚硬币

支付流程：
- Bob向Alice支付1枚币（B公司投资）→ 硬币变值3
- Alice向Carol支付1枚币（C公司投资）→ 硬币变值3
- 其他玩家向David支付币...

最终净资产排名：
1. Carol: 25 → +2分
2. Alice: 18 → +1分
3. Bob: 15 → 0分
4. David: 10 → -1分

### 策略提示

1. **控制大股东身份**：成为大股东虽然能获得收益，但也限制了你从市场抽取该公司的牌。要平衡投资分布。

2. **观察对手**：注意其他玩家的投资情况，避免在竞争激烈的公司过度投资。

3. **手牌管理**：合理利用两步骤行动，在适当的时候打出或保留牌。

4. **硬币策略**：
   - 从牌堆抽牌需要支付硬币，要确保有足够硬币
   - 从市场拿牌可以获得硬币，是补充硬币的好方法
   - 支付出去的硬币会增值到3，所以适当的支付也是一种策略

5. **市场观察**：
   - 注意市场区域的牌和上面的硬币数量
   - 规划好何时从市场拿牌，何时从牌堆抽牌
   - 利用反垄断规则的免费抽牌机制

6. **负资产管理**：尽量避免硬币耗尽，负资产会严重影响排名

## 常见问题

### 如何创建房间？
1. 进入游戏主页
2. 点击"创建房间"
3. 输入你的名字
4. 选择最大玩家数（3-7人）
5. 分享房间码给朋友

### 如何加入房间？
1. 获取朋友分享的房间码
2. 点击"加入房间"
3. 输入你的名字和房间码
4. 点击加入

### 游戏什么时候开始？
当房间内至少有3名玩家，且所有玩家都点击"准备"后，游戏自动开始。

### 如何知道该我行动了？
当前行动的玩家名字会高亮显示，如果是你的回合，会显示"你的回合"提示。

### 断线了怎么办？
目前版本暂不支持断线重连，请确保网络稳定。后续版本会添加此功能。

## 项目结构

```
chuchuang-company/
├── client/                 # 前端代码
│   ├── src/
│   │   ├── components/    # React 组件
│   │   ├── hooks/         # 自定义 Hooks
│   │   ├── contexts/      # Context API
│   │   ├── types/         # TypeScript 类型定义
│   │   └── App.tsx        # 主应用
│   └── package.json
│
├── server/                # 后端代码
│   ├── src/
│   │   ├── game/          # 游戏逻辑
│   │   ├── rooms/         # 房间管理
│   │   ├── socket/        # Socket.io 处理
│   │   ├── types/         # 类型定义
│   │   └── index.ts       # 服务器入口
│   └── package.json
│
└── README.md
```

## 开发路线图

- [x] 基础游戏功能
- [x] 多人房间系统
- [x] 实时游戏同步
- [x] 结算系统
- [x] 多轮游戏
- [ ] 断线重连
- [ ] 游戏回放
- [ ] 排行榜系统
- [ ] 聊天功能
- [ ] 移动端优化

## 贡献指南

欢迎提交问题和拉取请求！

1. Fork 本仓库
2. 创建你的特性分支 (`git checkout -b feature/AmazingFeature`)
3. 提交你的改动 (`git commit -m 'Add some AmazingFeature'`)
4. 推送到分支 (`git push origin feature/AmazingFeature`)
5. 开启一个 Pull Request

## 许可证

MIT License - 详见 LICENSE 文件

## 联系方式

如有问题或建议，欢迎提交 Issue。

---

**仅供个人学习使用**
